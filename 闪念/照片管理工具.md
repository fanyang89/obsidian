---
title: 场景
---

这是一个照片的一揽子管理工具。暂命名为 abc

# 场景

- 照片的导入。
  - 一个摄影师，从外面拍照归来，第一件要做的事情就是拷卡
  - 一个普通人，拍摄了很多猫猫照片，这些照片自动从手机上传到 abc
- 照片的去重
  - 自动上传的照片可能已经跟图库重复，需要保留质量最高的那一张，并且删除剩下的照片
  - 支持相似图片和重复图片的扫描。https://github.com/idealo/imagededup
- 照片的存储
  - 海量小文件适用于对象存储
  - 存到 vmdk？qcow2？需要支持的情况是，使用编辑工具打开任意一张图片，然后保存修改能写入回去
  - 可能是 juicefs + minio？性能太差。还是考虑 NAS 存一个 vmdk，本地挂载的方式。或者是本地缓存，打包成 vmdk 上传到 nas
    ![](assets/Pasted%20image%2020220720123504.png)
- 照片的备份
  - 公有云。比如阿里 OSS，七牛 OSS
  - 网盘。如阿里云盘，百度云
- 照片的分类
  - 自动给照片进行归类，自动打 tag

# 对于文件系统的需求

- 零散的照片整合为多个大文件。4G 为一个分卷。
- 支持在 Linux、macOS、Windows 下挂载
- 支持随机读写

使用 tar 作为 sstable，建立一个类似 LSM 的文件系统。

通过 FUSE 挂载

不实现文件系统。第一阶段通过 TrueNAS Scale 虚拟机实现。abc 通过 WebDAV 或者 smb 连接到虚拟机，做 I/O。

# 如何去重？

https://github.com/idealo/imagededup
