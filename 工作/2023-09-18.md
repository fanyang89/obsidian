```
lr-x------ 1 root root 64 Sep 16 17:00 0 -> /dev/null
lrwx------ 1 root root 64 Sep 16 17:00 1 -> socket:[577351246]
lrwx------ 1 root root 64 Sep 18 13:07 10 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 11 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 12 -> socket:[577303366]
lrwx------ 1 root root 64 Sep 18 13:07 13 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 14 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 15 -> anon_inode:[eventpoll]
lrwx------ 1 root root 64 Sep 18 13:07 16 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 17 -> anon_inode:[eventpoll]
lrwx------ 1 root root 64 Sep 18 13:07 18 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 19 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 16 17:00 2 -> socket:[577351246]
lrwx------ 1 root root 64 Sep 18 13:07 20 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 21 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 22 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 23 -> anon_inode:[eventpoll]
lrwx------ 1 root root 64 Sep 18 13:07 24 -> anon_inode:[eventfd]
lrwx------ 1 root root 64 Sep 18 13:07 25 -> anon_inode:[eventfd]
lr-x------ 1 root root 64 Sep 18 13:07 26 -> pipe:[692518572]
l-wx------ 1 root root 64 Sep 18 13:07 27 -> pipe:[692518572]
lrwx------ 1 root root 64 Sep 18 13:07 28 -> socket:[692518576]
lrwx------ 1 root root 64 Sep 18 13:07 29 -> socket:[692518610]  // <---- poll()
lr-x------ 1 root root 64 Sep 16 17:00 3 -> /dev/urandom
lrwx------ 1 root root 64 Sep 18 13:07 30 -> socket:[692518611]
lrwx------ 1 root root 64 Sep 18 13:07 4 -> socket:[577303363]
lrwx------ 1 root root 64 Sep 18 13:07 5 -> socket:[577303364]
l-wx------ 1 root root 64 Sep 18 13:07 6 -> /var/lib/zbs/metad/lock
l-wx------ 1 root root 64 Sep 18 13:07 7 -> /var/log/zbs/zbs-metad.log.20230918-075346.31516
lrwx------ 1 root root 64 Sep 18 13:07 8 -> anon_inode:[eventpoll]
lrwx------ 1 root root 64 Sep 18 13:07 9 -> anon_inode:[eventfd]
```

```
I0917 05:25:17.037914 31576 dump_meta.cc:97] Dump meta from 10.0.130.72:10100
W0917 05:25:27.038408 31576 dump_meta.cc:104] Fail to dump meta from 10.0.130.72:10100 st:
Traceback:
[ETimedOut]: failed to read response header when calling: zbs.meta.MetaService.ListDb
I0917 05:25:27.039000 31576 meta.cc:1736] [LIBMETA ADDR UPDATE]  old meta ip: 10.0.130.72 old meta port: 10100
 new meta ip: 10.0.130.73 new meta port: 10100
I0917 05:25:27.039075 31576 dump_meta.cc:97] Dump meta from 10.0.130.73:10100
W0917 05:25:37.049017 31576 dump_meta.cc:104] Fail to dump meta from 10.0.130.73:10100 st:
Traceback:
[ETimedOut]: failed to read response header when calling: zbs.meta.MetaService.ListDb
```

![](assets/Pasted%20image%2020230919112630.png)

![](assets/Pasted%20image%2020230919113302.png)

![|600](assets/Pasted%20image%2020230919113328.png)

```
COMMAND     PID USER   FD      TYPE             DEVICE SIZE/OFF      NODE NAME
zbs-metad 31516   0   29u     IPv4          748549945      0t0       TCP node130-71:60956->10.0.130.72:10100 (ESTABLISHED)

// netstat 找不到这个 socket

zbs-metad 31516 root   28u     IPv4          748905564      0t0       TCP node130-71:36190->10.0.130.72:eforward 2181 (ESTABLISHED)
zbs-metad 31516 root   29u     IPv4          748905598      0t0       TCP node130-71:50952->10.0.130.72:itap-ddtp 10100 (ESTABLISHED)
zbs-metad 31516 root   30u     IPv4          748905599      0t0       TCP node130-71:46010->10.0.130.72:ezmeeting-2 10101 (ESTABLISHED)

$ ss -4ntipmona | grep -A1 meta
LISTEN     0      511          *:10102                    *:*                   users:(("zbs-metad",pid=31516,fd=12))
         skmem:(r0,rb87380,t0,tb65536,f0,w0,o0,bl0) cubic cwnd:10
--
ESTAB      0      0      10.0.130.71:44950              10.0.130.73:2181                users:(("zbs-metad",pid=31516,fd=28))
         skmem:(r0,rb367360,t0,tb174080,f0,w0,o0,bl0) ts sack cubic wscale:9,9 rto:201 rtt:0.822/1.189 ato:40 mss:1448 cwnd:10 ssthresh:825 bytes_acked:238 bytes_received:415 segs_out:29 segs_in:20 send 140.9Mbps lastsnd:1209 lastrcv:1209 lastack:1209 pacing_rate 281.8Mbps retrans:0/2 reordering:19 rcv_space:29200
--
ESTAB      0      0      10.0.130.71:42428              10.0.130.72:10100               users:(("zbs-metad",pid=31516,fd=29)) timer:(keepalive,325ms,0)
         skmem:(r0,rb367360,t0,tb87040,f0,w0,o0,bl0) ts sack cubic wscale:9,9 rto:201 rtt:0.088/0.048 mss:1448 cwnd:10 ssthresh:703 bytes_acked:33 segs_out:17 segs_in:16 send 1316.4Mbps lastsnd:7878 lastrcv:7878 lastack:675 pacing_rate 2632.7Mbps rcv_space:29200
--
ESTAB      0      0      10.0.130.71:37484              10.0.130.72:10101               users:(("zbs-metad",pid=31516,fd=30)) timer:(keepalive,322ms,0)
         skmem:(r0,rb367360,t0,tb87040,f0,w0,o0,bl0) ts sack cubic wscale:9,9 rto:202 rtt:0.063/0.031 mss:1448 cwnd:10 ssthresh:703 bytes_acked:1 segs_out:16 segs_in:15 send 1838.7Mbps lastsnd:7881 lastrcv:7881 lastack:678 pacing_rate 3677.5Mbps rcv_space:29200

[root@node130-71 12:06:04 2023-09-17]$ lsof -p $(pidof zbs-metad)
lsof: WARNING: can't stat() nfs file system /usr/share/smartx/volumes
      Output information may be incomplete.
COMMAND     PID USER   FD      TYPE             DEVICE SIZE/OFF      NODE NAME
zbs-metad 31516 root  cwd       DIR              9,127     4096         2 /
zbs-metad 31516 root  rtd       DIR              9,127     4096         2 /
zbs-metad 31516 root  txt       REG              9,127  7907320    406914 /usr/sbin/zbs-metad
zbs-metad 31516 root  mem       REG              9,127    37096    396571 /usr/lib64/libnss_sss.so.2
zbs-metad 31516 root  mem       REG              9,127    62184    394338 /usr/lib64/libnss_files-2.17.so
zbs-metad 31516 root  mem       REG              9,127    32304    394805 /usr/lib64/libffi.so.6.0.1
zbs-metad 31516 root  mem       REG              9,127    68192    394549 /usr/lib64/libbz2.so.1.0.6
zbs-metad 31516 root  mem       REG              9,127    99944    394690 /usr/lib64/libelf-0.168.so
zbs-metad 31516 root  mem       REG              9,127    19888    394791 /usr/lib64/libattr.so.1.1.0
zbs-metad 31516 root  mem       REG              9,127   495712    394963 /usr/lib64/libgmp.so.10.2.0
zbs-metad 31516 root  mem       REG              9,127   160776    394977 /usr/lib64/libhogweed.so.2.5
zbs-metad 31516 root  mem       REG              9,127   201296    394979 /usr/lib64/libnettle.so.4.7
zbs-metad 31516 root  mem       REG              9,127    78056    395083 /usr/lib64/libtasn1.so.6.5.3
zbs-metad 31516 root  mem       REG              9,127  1261848    394808 /usr/lib64/libp11-kit.so.0.3.0
zbs-metad 31516 root  mem       REG              9,127   297328    401649 /usr/lib64/libdw-0.168.so
zbs-metad 31516 root  mem       REG              9,127   111080    394348 /usr/lib64/libresolv-2.17.so
zbs-metad 31516 root  mem       REG              9,127   157424    394519 /usr/lib64/liblzma.so.5.2.2
zbs-metad 31516 root  mem       REG              9,127   155744    394504 /usr/lib64/libselinux.so.1
zbs-metad 31516 root  mem       REG              9,127    20032    394795 /usr/lib64/libcap.so.2.22
zbs-metad 31516 root  mem       REG              9,127    19384    394700 /usr/lib64/libgpg-error.so.0.10.0
zbs-metad 31516 root  mem       REG              9,127   535064    394717 /usr/lib64/libgcrypt.so.11.8.2
zbs-metad 31516 root  mem       REG              9,127  1300528    405232 /usr/lib64/libgnutls.so.28.43.0
zbs-metad 31516 root  mem       REG              9,127   444816    394538 /usr/lib64/libnl-route-3.so.200.23.0
zbs-metad 31516 root  mem       REG              9,127   139016    394530 /usr/lib64/libnl-3.so.200.23.0
zbs-metad 31516 root  mem       REG              9,127    90664    394507 /usr/lib64/libz.so.1.2.7
zbs-metad 31516 root  mem       REG              9,127    32424    395071 /usr/lib64/liburcu-cds.so.2.0.0
zbs-metad 31516 root  mem       REG              9,127    28760    395069 /usr/lib64/liburcu-bp.so.2.0.0
zbs-metad 31516 root  mem       REG              9,127    44704    395108 /usr/lib64/liblttng-ust-tracepoint.so.0.0.0
zbs-metad 31516 root  mem       REG              9,127  2127336    394320 /usr/lib64/libc-2.17.so
zbs-metad 31516 root  mem       REG              9,127    88720    393235 /usr/lib64/libgcc_s-4.8.5-20150702.so.1
zbs-metad 31516 root  mem       REG              9,127  1139680    394328 /usr/lib64/libm-2.17.so
zbs-metad 31516 root  mem       REG              9,127   995840    394366 /usr/lib64/libstdc++.so.6.0.19
zbs-metad 31516 root  mem       REG              9,127    23800    394961 /usr/lib64/libsnappy.so.1.1.4
zbs-metad 31516 root  mem       REG              9,127    99584    405348 /usr/lib64/libmicrohttpd.so.10.22.0
zbs-metad 31516 root  mem       REG              9,127   402384    394495 /usr/lib64/libpcre.so.1.2.0
zbs-metad 31516 root  mem       REG              9,127    48904    395303 /usr/lib64/libunwind.so.8.0.1
zbs-metad 31516 root  mem       REG              9,127   366464    397040 /usr/lib64/libfdisk.so.1.1.0
zbs-metad 31516 root  mem       REG              9,127    44448    394350 /usr/lib64/librt-2.17.so
zbs-metad 31516 root  mem       REG              9,127    20040    394528 /usr/lib64/libuuid.so.1.3.0
zbs-metad 31516 root  mem       REG              9,127   261336    395740 /usr/lib64/libblkid.so.1.1.0
zbs-metad 31516 root  mem       REG              9,127  2520920    395500 /usr/lib64/libcrypto.so.1.0.2k
zbs-metad 31516 root  mem       REG              9,127   530856    397280 /usr/lib64/libzstd.so.1.3.4
zbs-metad 31516 root  mem       REG              9,127    15352    395073 /usr/lib64/liburcu-common.so.2.0.0
zbs-metad 31516 root  mem       REG              9,127    28632    395081 /usr/lib64/liburcu.so.2.0.0
zbs-metad 31516 root  mem       REG              9,127    49176    395251 /usr/lib64/libsysfs.so.2.0.1
zbs-metad 31516 root  mem       REG              9,127   210368    403959 /usr/lib64/libcgroup.so.1.0.42
zbs-metad 31516 root  mem       REG              9,127   127192    394783 /usr/lib64/libibverbs.so.1.14.35.0
zbs-metad 31516 root  mem       REG              9,127   105568    394853 /usr/lib64/librdmacm.so.1.3.35.0
zbs-metad 31516 root  mem       REG              9,127  1124536    395428 /usr/lib64/libprotobuf.so.8.0.0
zbs-metad 31516 root  mem       REG              9,127    19776    394326 /usr/lib64/libdl-2.17.so
zbs-metad 31516 root  mem       REG              9,127   144792    394346 /usr/lib64/libpthread-2.17.so
zbs-metad 31516 root  mem       REG              9,127   425584    395110 /usr/lib64/liblttng-ust.so.0.0.0
zbs-metad 31516 root  mem       REG              9,127   164264    394313 /usr/lib64/ld-2.17.so
zbs-metad 31516 root  mem       REG              9,127   162560    401662 /usr/lib64/libsystemd.so.0.6.0
zbs-metad 31516 root    0r      CHR                1,3      0t0      2060 /dev/null
zbs-metad 31516 root    1u     unix 0x00000000dcedd73b      0t0 577351246 socket
zbs-metad 31516 root    2u     unix 0x00000000dcedd73b      0t0 577351246 socket
zbs-metad 31516 root    3r      CHR                1,9      0t0      2065 /dev/urandom
zbs-metad 31516 root    4u     unix 0x00000000e5c0b62b      0t0 577303363 socket
zbs-metad 31516 root    5u     unix 0x00000000a490f45f      0t0 577303364 socket
zbs-metad 31516 root    6ww     REG                9,0        0        12 /var/lib/zbs/metad/lock
zbs-metad 31516 root    7w      REG              9,127 13035148   3146020 /var/log/zbs/zbs-metad.log.20230919-085454.31516
zbs-metad 31516 root    8u  a_inode               0,14        0     12208 [eventpoll]
zbs-metad 31516 root    9u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   10u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   11u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   12u     IPv4          577303366      0t0       TCP *:ezproxy-2 (LISTEN)
zbs-metad 31516 root   13u  a_inode               0,14        0     12208 [eventpoll]
zbs-metad 31516 root   14u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   15u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   16u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   17u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   18u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   19u  a_inode               0,14        0     12208 [eventpoll]
zbs-metad 31516 root   20u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   21u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   22u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   23u  a_inode               0,14        0     12208 [eventpoll]
zbs-metad 31516 root   24u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   25u  a_inode               0,14        0     12208 [eventfd]
zbs-metad 31516 root   26r     FIFO               0,13      0t0 748905556 pipe
zbs-metad 31516 root   27w     FIFO               0,13      0t0 748905556 pipe
zbs-metad 31516 root   28u     IPv4          748905564      0t0       TCP node130-71:36190->10.0.130.72:eforward 2181 (ESTABLISHED)
zbs-metad 31516 root   29u     IPv4          748905598      0t0       TCP node130-71:50952->10.0.130.72:itap-ddtp 10100 (ESTABLISHED)
zbs-metad 31516 root   30u     IPv4          748905599      0t0       TCP node130-71:46010->10.0.130.72:ezmeeting-2 10101 (ESTABLISHED)
zbs-metad 31516 root   31w      REG                9,0      288    655390 /var/lib/zbs/metad/db/meta.sync/meta/e/LOG
zbs-metad 31516 root   32uW     REG                9,0        0    655394 /var/lib/zbs/metad/db/meta.sync/meta/e/LOCK
zbs-metad 31516 root   33w      REG                9,0        0    655402 /var/lib/zbs/metad/db/meta.sync/meta/e/000003.log
zbs-metad 31516 root   34w      REG                9,0       42    655403 /var/lib/zbs/metad/db/meta.sync/meta/e/MANIFEST-000002
```

```
4.18.0-193.28.1.el7.smartx.14.x86_64
```

```
[root@node130-71 12:36:14 31516]$ cat task/31576/stack
[<0>] poll_schedule_timeout.constprop.13+0x42/0x70
[<0>] do_sys_poll+0x493/0x520
[<0>] __x64_sys_poll+0x9c/0x130
[<0>] do_syscall_64+0x5b/0x1a0
[<0>] entry_SYSCALL_64_after_hwframe+0x65/0xca
```

![|600](assets/Pasted%20image%2020230919124421.png)

```
[root@node130-71 12:49:05 31516]$ strace -p 31516
strace: Process 31516 attached
restart_syscall(<... resuming interrupted nanosleep ...>) = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, NULL)         = 0
nanosleep({0, 100000000}, ^Cstrace: Process 31516 detached
 <detached ...>
```

![|600](assets/Pasted%20image%2020230919125929.png)
