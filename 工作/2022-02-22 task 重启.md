```
[root@node-19-17 15:44:42 ~]$systemctl status zbs-taskd
● zbs-taskd.service - ZBS task service
   Loaded: loaded (/usr/lib/systemd/system/zbs-taskd.service; enabled; vendor preset: disabled)
  Drop-In: /etc/systemd/system/zbs-taskd.service.d
           └─cgroup.conf
   Active: active (running) since Mon 2022-02-21 17:51:26 CST; 1 day 21h ago
 Main PID: 48281 (zbs-taskd)
   CGroup: /system.slice/system-zbs.slice/system-zbs-others.slice/zbs-taskd.service
           └─48281 /usr/sbin/zbs-taskd -taskd_leveldb_path=/var/lib/zbs/taskd/db/ --foreground

Feb 21 17:51:26 node-19-17 systemd[1]: Started ZBS task service.
[root@node-19-17 15:44:48 ~]$date
Wed Feb 23 15:45:40 CST 2022
```

```
[root@node-19-18 15:46:05 ~]$systemctl status zbs-taskd
● zbs-taskd.service - ZBS task service
   Loaded: loaded (/usr/lib/systemd/system/zbs-taskd.service; enabled; vendor preset: disabled)
  Drop-In: /etc/systemd/system/zbs-taskd.service.d
           └─cgroup.conf
   Active: active (running) since Mon 2022-02-21 17:51:27 CST; 1 day 21h ago
 Main PID: 35147 (zbs-taskd)
   CGroup: /system.slice/system-zbs.slice/system-zbs-others.slice/zbs-taskd.service
           └─35147 /usr/sbin/zbs-taskd -taskd_leveldb_path=/var/lib/zbs/taskd/db/ --foreground

Feb 21 17:51:27 node-19-18 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 21 17:51:27 node-19-18 systemd[1]: Stopped ZBS task service.
Feb 21 17:51:27 node-19-18 systemd[1]: Started ZBS task service.
[root@node-19-18 15:46:10 ~]$date
Wed Feb 23 15:46:15 CST 2022
```

```
[root@node-19-19 15:46:34 ~]$systemctl status zbs-taskd
● zbs-taskd.service - ZBS task service
   Loaded: loaded (/usr/lib/systemd/system/zbs-taskd.service; enabled; vendor preset: disabled)
  Drop-In: /etc/systemd/system/zbs-taskd.service.d
           └─cgroup.conf
   Active: active (running) since Mon 2022-02-21 17:51:22 CST; 1 day 21h ago
 Main PID: 26007 (zbs-taskd)
   CGroup: /system.slice/system-zbs.slice/system-zbs-others.slice/zbs-taskd.service
           └─26007 /usr/sbin/zbs-taskd -taskd_leveldb_path=/var/lib/zbs/taskd/db/ --foreground

Feb 21 17:51:22 node-19-19 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 21 17:51:22 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 21 17:51:22 node-19-19 systemd[1]: Started ZBS task service.
[root@node-19-19 15:46:38 ~]$date
Wed Feb 23 15:46:39 CST 2022
```

1d21h 前，也就是 02-22 15:46:00 - 21h = 02-22 00:46:00 - 6 = 02-21 18:46:00

```
I0221 17:51:22.353945 26007 quorum_cluster.cc:93] Initializing quorum cluster.

W0221 17:57:38.298418 26008 main.cc:84] [ZOO] zookeeper_interest:1635 Exceeded deadline by 19ms
// ...
W0223 15:44:38.008206 26008 main.cc:84] [ZOO] zookeeper_interest:1635 Exceeded deadline by 11ms
```

```
[root@node-19-19 15:56:02 zbs]$rpm -qa | grep zbs
zbs-proto-4.0.8-rc1.1.release.git.gdb5b4cef0.el7.SMTX.aarch64
libzbs-4.0.11-rc19.0.release.git.gfd4159884.el7.SMTX.HCI.aarch64
zbs-4.0.11-rc21.0.release.git.g110df4bea.el7.SMTX.HCI.aarch64
zbs-debuginfo-4.0.10-rc21.0.release.git.gfb869a3b4.el7.SMTX.aarch64
pyzbs-4.0.11-rc36.0.git.g54fc193.el7.aarch64
```

```
[root@node-19-19 15:55:59 zbs]$journalctl -u zbs-taskd
-- Logs begin at Sun 2022-01-30 21:50:03 CST, end at Wed 2022-02-23 15:56:01 CST. --
Feb 10 14:28:20 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=1/FAILURE
Feb 10 14:28:20 node-19-19 systemd[1]: Unit zbs-taskd.service entered failed state.
Feb 10 14:28:20 node-19-19 systemd[1]: zbs-taskd.service failed.
Feb 10 14:28:20 node-19-19 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 10 14:28:20 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 10 14:28:20 node-19-19 systemd[1]: Started ZBS task service.
Feb 16 11:27:11 node-19-19 systemd[1]: Stopping ZBS task service...
Feb 16 11:27:11 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=80/n/a
Feb 16 11:27:11 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 16 11:27:11 node-19-19 systemd[1]: Unit zbs-taskd.service entered failed state.
Feb 16 11:27:11 node-19-19 systemd[1]: zbs-taskd.service failed.
Feb 16 11:27:11 node-19-19 systemd[1]: Started ZBS task service.
Feb 21 17:51:08 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
Feb 21 17:51:08 node-19-19 systemd[1]: Unit zbs-taskd.service entered failed state.
Feb 21 17:51:08 node-19-19 systemd[1]: zbs-taskd.service failed.
Feb 21 17:51:08 node-19-19 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 21 17:51:08 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 21 17:51:08 node-19-19 systemd[1]: Started ZBS task service.
Feb 21 17:51:15 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
Feb 21 17:51:15 node-19-19 systemd[1]: Unit zbs-taskd.service entered failed state.
Feb 21 17:51:15 node-19-19 systemd[1]: zbs-taskd.service failed.
Feb 21 17:51:15 node-19-19 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 21 17:51:15 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 21 17:51:15 node-19-19 systemd[1]: Started ZBS task service.
Feb 21 17:51:22 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
Feb 21 17:51:22 node-19-19 systemd[1]: Unit zbs-taskd.service entered failed state.
Feb 21 17:51:22 node-19-19 systemd[1]: zbs-taskd.service failed.
Feb 21 17:51:22 node-19-19 systemd[1]: zbs-taskd.service holdoff time over, scheduling restart.
Feb 21 17:51:22 node-19-19 systemd[1]: Stopped ZBS task service.
Feb 21 17:51:22 node-19-19 systemd[1]: Started ZBS task service.
```

19.18 确切时间点：

- Feb 21 17:51:21 node-19-18 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:27 node-19-18 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:14 node-19-18 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a

```
I0221 17:51:27.763693 35108 task_vip_service.cc:470] Local secondary data channel was invalid, restart.

I0221 17:51:21.247484 34986 task_vip_service.cc:470] Local secondary data channel was invalid, restart.

I0221 17:51:14.753855 55820 task_vip_service.cc:470] Local secondary data channel was invalid, restart.
```

19.17

- Feb 21 17:51:11 node-19-17 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:18 node-19-17 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:25 node-19-17 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a

```
./zbs-taskd.log.20220216-184726.47467:I0221 17:51:11.604106 47475 task_vip_service.cc:470] Local secondary data channel was invalid, restart.
./zbs-taskd.log.20220221-175111.48119:I0221 17:51:18.154671 48123 task_vip_service.cc:470] Local secondary data channel was invalid, restart.
I0221 17:51:24.916468 48183 task_vip_service.cc:470] Local secondary data channel was invalid, restart.
```

19.19

- Feb 21 17:51:08 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:15 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a
- Feb 21 17:51:22 node-19-19 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=115/n/a

## 25.65 task 重启

Feb 22 09:47:59 Node25-65 systemd[1]: zbs-taskd.service: main process exited, code=exited, status=1/FAILURE

```
E0222 09:47:55.694850 32650 main.cc:81] [ZOO] handle_socket_error_msg:2495 2022-02-22 09:47:55,694:32649(0x7f9b9d3ad700):ZOO_ERROR@handle_socket_error_msg@2495: Socket
[10.168.25.65:2181] zk retcode=-4, errno=112(Host is down): failed while receiving a server response
W0222 09:47:55.694953 32652 zookeeper.cc:223] zookeeper session event:  old state: CONNECTED_STATE new state: CONNECTING_STATE
W0222 09:47:55.694979 32652 zookeeper.cc:186] Start the session timeout timer: 3600
I0222 09:47:55.695000 32652 quorum_cluster.cc:443] QuorumCluster state change: Running --> Running_Connecting
W0222 09:47:59.295037 32652 zookeeper.cc:202] Stop the session timeout timer.
W0222 09:47:59.857657 32652 zookeeper.cc:223] zookeeper session event:  old state: CONNECTING_STATE new state: EXPIRED_SESSION_STATE
E0222 09:47:59.857682 32652 quorum_cluster.cc:349] Zookeeper session timeout.
I0222 09:47:59.857689 32652 quorum_cluster.cc:443] QuorumCluster state change: Running_Connecting --> Expired
I0222 09:47:59.857700 32652 quorum_server.cc:64] Get quorum cluster event: EXPIRED
W0222 09:47:59.857707 32652 quorum_server.cc:79] Session expired.
E0222 09:47:59.857712 32652 task_server.cc:297] Session lost, must exit to prevent the tasks from running in this task server.
E0222 09:47:59.697213 32650 main.cc:81] [ZOO] handle_socket_error_msg:2390 2022-02-22 09:47:59,697:32649(0x7f9b9d3ad700):ZOO_ERROR@handle_socket_error_msg@2390: Socket[10.168.25.66:2181] zk retcode=-7, errno=110(Connection timed out): connection to 10.168.25.66:2181 timed out (exceeded timeout by 2ms)
```

```
zbs-ntpd.log.20220207-225758.17894:E0222 09:47:55.695571 18956 main.cc:81] [ZOO] handle_socket_error_msg:2495 2022-02-22 09:47:55,695:17894(0x7fdd8a10b700):ZOO_ERROR@handle_socket_error_msg@2495: Socket [10.168.25.65:2181] zk retcode=-4, errno=112(Host is down): failed while receiving a server response
zbs-ntpd.log.20220207-225758.17894:W0222 09:47:55.695729 18978 zookeeper.cc:223] zookeeper session event:  old state: CONNECTED_STATE new state: CONNECTING_STATE
zbs-ntpd.log.20220207-225758.17894:W0222 09:47:55.695744 18978 zookeeper.cc:186] Start the session timeout timer: 3600
zbs-ntpd.log.20220207-225758.17894:I0222 09:47:55.695757 18978 quorum_cluster.cc:443] QuorumCluster state change: Running --> Running_Connecting
zbs-ntpd.log.20220207-225758.17894:W0222 09:47:55.796485 18978 zookeeper.cc:223] zookeeper session event:  old state: CONNECTING_STATE new state: CONNECTED_STATE
zbs-ntpd.log.20220207-225758.17894:W0222 09:47:55.797433 18978 zookeeper.cc:202] Stop the session timeout timer.
zbs-ntpd.log.20220207-225758.17894:I0222 09:47:55.797464 18978 quorum_cluster.cc:443] QuorumCluster state change: Running_Connecting --> Running
zbs-ntpd.log.20220207-225758.17894:I0222 09:47:55.798657 18978 quorum_cluster.cc:698] Ger priority config:
zbs-ntpd.log.20220207-225758.17894:I0222 09:47:55.798696 18978 quorum_cluster.cc:529] Leader is 10.168.25.67:0. seq is 939745
zbs-taskd.log.20220220-172230.32649:E0222 09:47:55.694850 32650 main.cc:81] [ZOO] handle_socket_error_msg:2495 2022-02-22 09:47:55,694:32649(0x7f9b9d3ad700):ZOO_ERROR@handle_socket_error_msg@2495: Socket [10.168.25.65:2181] zk retcode=-4, errno=112(Host is down): failed while receiving a server response
zbs-taskd.log.20220220-172230.32649:W0222 09:47:55.694953 32652 zookeeper.cc:223] zookeeper session event:  old state: CONNECTED_STATE new state: CONNECTING_STATE
zbs-taskd.log.20220220-172230.32649:W0222 09:47:55.694979 32652 zookeeper.cc:186] Start the session timeout timer: 3600
zbs-taskd.log.20220220-172230.32649:I0222 09:47:55.695000 32652 quorum_cluster.cc:443] QuorumCluster state change: Running --> Running_Connecting
zbs-metad.log.20220104-183036.17954:E0222 09:47:55.694746 18925 main.cc:81] [ZOO] handle_socket_error_msg:2495 2022-02-22 09:47:55,694:17954(0x7f9f6121b700):ZOO_ERROR@handle_socket_error_msg@2495: Socket [10.168.25.65:2181] zk retcode=-4, errno=112(Host is down): failed while receiving a server response
zbs-metad.log.20220104-183036.17954:W0222 09:47:55.694916 17961 zookeeper.cc:223] zookeeper session event:  old state: CONNECTED_STATE new state: CONNECTING_STATE
zbs-metad.log.20220104-183036.17954:W0222 09:47:55.694932 17961 zookeeper.cc:186] Start the session timeout timer: 3600
zbs-metad.log.20220104-183036.17954:I0222 09:47:55.694947 17961 quorum_cluster.cc:443] QuorumCluster state change: Running --> Running_Connecting
```
