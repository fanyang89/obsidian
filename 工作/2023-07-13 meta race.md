```
==836530==
==836530== Possible data race during write of size 1 at 0xBBE1ED0 by thread #5
==836530== Locks held: none
==836530==    at 0x13E8277: zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::~AsyncBatchHandleQueueImpl() (async_queue.h:48)
==836530==    by 0x13EAC67: zbs::EventLoopThreadContextImpl::~EventLoopThreadContextImpl() (thread_context.cc:54)
==836530==    by 0x13EAC8F: zbs::EventLoopThreadContextImpl::~EventLoopThreadContextImpl() (thread_context.cc:54)
==836530==    by 0x13EA9D1: std::default_delete<zbs::ThreadContext::ThreadContextImpl>::operator()(zbs::ThreadContext::ThreadContextImpl*) const (unique_ptr.h:78)
==836530==    by 0x13E8C88: std::unique_ptr<zbs::ThreadContext::ThreadContextImpl, std::default_delete<zbs::ThreadContext::ThreadContextImpl> >::~unique_ptr() (unique_ptr.h:268)
==836530==    by 0x13E6DB8: zbs::ThreadContext::~ThreadContext() (thread_context.cc:180)
==836530==    by 0x13E6E3D: zbs::ThreadContext::~ThreadContext() (thread_context.cc:198)
==836530==    by 0x13E7753: zbs::ThreadContext::UnregisterThread(zbs::ThreadContext*) (thread_context.cc:304)
==836530==    by 0x10229CC: zbs::ThreadContextDeleter::operator()(zbs::ThreadContext*) (thread_context.h:128)
==836530==    by 0x1028B1E: std::unique_ptr<zbs::ThreadContext, zbs::ThreadContextDeleter>::reset(zbs::ThreadContext*) (unique_ptr.h:376)
==836530==    by 0x1027E60: std::unique_ptr<zbs::ThreadContext, zbs::ThreadContextDeleter>::operator=(decltype(nullptr)) (unique_ptr.h:312)
==836530==    by 0x1127F21: zbs::meta::MetaServer::StopStatusServer() (meta_server.cc:270)
==836530==
==836530== This conflicts with a previous read of size 1 by thread #17
==836530== Locks held: none
==836530==    at 0x13E9BB1: zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::OnEvent(unsigned int) (async_queue.h:186)
==836530==    by 0x13F082D: void std::__invoke_impl<void, void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*&)(unsigned int), zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*&, unsigned int>(std::__invoke_memfun_deref, void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*&)(unsigned int), zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*&, unsigned int&&) (invoke.h:73)
==836530==    by 0x13EFCEE: std::__invoke_result<void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*&)(unsigned int), zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*&, unsigned int>::type std::__invoke<void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*&)(unsigned int), zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*&, unsigned int>(void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*&)(unsigned int), zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*&, unsigned int&&) (invoke.h:95)
==836530==    by 0x13EEBAB: void std::_Bind<void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*(zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*, std::_Placeholder<1>))(unsigned int)>::__call<void, unsigned int&&, 0ul, 1ul>(std::tuple<unsigned int&&>&&, std::_Index_tuple<0ul, 1ul>) (functional:467)
==836530==    by 0x13ED4BF: void std::_Bind<void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*(zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*, std::_Placeholder<1>))(unsigned int)>::operator()<unsigned int, void>(unsigned int&&) (functional:551)
==836530==    by 0x13EBA2D: std::_Function_handler<void (unsigned int), std::_Bind<void (zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::*(zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >*, std::_Placeholder<1>))(unsigned int)> >::_M_invoke(std::_Any_data const&, unsigned int&&) (std_function.h:316)
==836530==    by 0x1377C3F: std::function<void (unsigned int)>::operator()(unsigned int) const (std_function.h:706)
==836530==    by 0x1375884: zbs::EventLoop::ExecEvent(zbs::EventLoop::Event*) (event_loop.cc:301)
==836530==  Address 0xbbe1ed0 is 16 bytes inside a block of size 24 alloc'd
==836530==    at 0x4837F83: operator new(unsigned long) (vg_replace_malloc.c:472)
==836530==    by 0x13F0F5E: __gnu_cxx::new_allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> >::allocate(unsigned long, void const*) (new_allocator.h:111)
==836530==    by 0x13F0C0E: std::allocator_traits<std::allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> > >::allocate(std::allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> >&, unsigned long) (alloc_traits.h:436)
==836530==    by 0x13F05B3: std::__allocated_ptr<std::allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> > > std::__allocate_guarded<std::allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> > >(std::allocator<std::_Sp_counted_ptr_inplace<bool, std::allocator<bool>, (__gnu_cxx::_Lock_policy)2> >&) (allocated_ptr.h:104)
==836530==    by 0x13EFA24: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<bool, std::allocator<bool>, bool>(std::_Sp_make_shared_tag, bool*, std::allocator<bool> const&, bool&&) (shared_ptr_base.h:635)
==836530==    by 0x13EE989: std::__shared_ptr<bool, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<bool>, bool>(std::_Sp_make_shared_tag, std::allocator<bool> const&, bool&&) (shared_ptr_base.h:1295)
==836530==    by 0x13ED30C: std::shared_ptr<bool>::shared_ptr<std::allocator<bool>, bool>(std::_Sp_make_shared_tag, std::allocator<bool> const&, bool&&) (shared_ptr.h:344)
==836530==    by 0x13EB82C: std::shared_ptr<bool> std::allocate_shared<bool, std::allocator<bool>, bool>(std::allocator<bool> const&, bool&&) (shared_ptr.h:691)
==836530==    by 0x13E980C: std::shared_ptr<bool> std::make_shared<bool, bool>(bool&&) (shared_ptr.h:707)
==836530==    by 0x13E7FD1: zbs::AsyncBatchHandleQueueImpl<zbs::Coroutine*, true, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)>, std::function<void (zbs::Coroutine* const&)> >::AsyncBatchHandleQueueImpl(zbs::EventLoop*, std::function<void (std::deque<zbs::Coroutine*, std::allocator<zbs::Coroutine*> >&&)> const&) (async_queue.h:36)
==836530==    by 0x13E6186: zbs::EventLoopThreadContextImpl::EventLoopThreadContextImpl(zbs::EventLoop*, zbs::ThreadContext*) (thread_context.cc:68)
==836530==    by 0x13E8ED4: std::_MakeUniq<zbs::EventLoopThreadContextImpl>::__single_object std::make_unique<zbs::EventLoopThreadContextImpl, zbs::EventLoop*, zbs::ThreadContext*>(zbs::EventLoop*&&, zbs::ThreadContext*&&) (unique_ptr.h:825)
==836530==  Block was alloc'd by thread #5
==836530==
==836530== ----------------------------------------------------------------
```
