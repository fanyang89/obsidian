```amber
import { exit, split, lines, trim, words } from "std"

// go install github.com/rlmcpherson/s3gof3r/gof3r@latest

main(args) {
  let public_dir = "./blog/.vuepress/public"

  let link_str = $ rg -NI '!\[.*\]\((.+)\)' -r '\$1' $?
  loop link in lines(link_str) {
    let link = trim(link)
    let image_base_dir = $ dirname {link} $?
    let image_ext = $ echo {link} | awk -F. '\{print \$NF}' $?
    let image_path = "{public_dir}/{link}"
    let hash = words($ sha1sum {image_path} $?)
    let hash_name = "{hash[0]}.{image_ext}"

    echo "{link} -> {hash_name}"

    // to upload
    // gof3r --endpoint "https://<ACCOUNT_ID>.r2.cloudflarestorage.com" --bucket "" -p ./1.png -k key.png
  }
}
```

```
存储桶：
blobs

使用此令牌对 Cloudflare API 进行身份验证：
令牌值
fIUZbBLs1YfdOEJnkdAWgQsKMPYVSW3h2D-fBFeo

为 S3 客户端使用以下凭据：
访问密钥 ID
89a4f6dd5f4766b37d01a2f15e9bf419

机密访问密钥
d06a0f91a4357ce6426a901eeda4ea3934ec0db693ee0c5eb083d322d53c9b1a

为 S3 客户端使用管辖权地特定的终结点：
https://c283aca010dd9ad5c07b70704815681c.r2.cloudflarestorage.com
```
