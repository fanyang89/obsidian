```
fanmi@arc [17:02:00] [~/workspace/aistor] [main *]
-> % uv run imagenet.py export_ff_records --output /mnt/datasets/ImageNET-1k/imagenet-1k.ffr
/home/fanmi/workspace/aistor/.venv/lib/python3.12/site-packages/ffrecord/__init__.py:1: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import get_distribution
/home/fanmi/workspace/aistor/.venv/lib/python3.12/site-packages/datasets/table.py:1421: FutureWarning: promote has been superseded by promote_options='default'.
  table = cls._concat_blocks(blocks, axis=0)
create ds, elapsed: 2.5605690479278564
 89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 1145447/1281167 [21:02<02:29, 907.31it/s]
Traceback (most recent call last):
  File "/home/fanmi/workspace/aistor/imagenet.py", line 56, in <module>
    fire.Fire(ImageNET)
  File "/home/fanmi/workspace/aistor/.venv/lib/python3.12/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fanmi/workspace/aistor/.venv/lib/python3.12/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ^^^^^^^^^^^^^^^^^^^^
  File "/home/fanmi/workspace/aistor/.venv/lib/python3.12/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
                ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/fanmi/workspace/aistor/imagenet.py", line 51, in export_ff_records
    writer.write_one(data)
RuntimeError: 'res == len_i' failed. Sample 1145447: length 534000 but wrote 1514 bytes
Error in void ffrecord::FileWriter::write_one(const uint8_t*, int64_t) at /home/fanmi/workspace/aistor/ffrecord/ffrecord/src/writer.cpp line 40
terminate called after throwing an instance of 'std::runtime_error'
  what():  'count == n' failed. Number of samples mismatched! Wrote 1145447 samples but expected 1281167
Error in void ffrecord::FileWriter::finish() at /home/fanmi/workspace/aistor/ffrecord/ffrecord/src/writer.cpp line 49
```
