---
title: "2024-12-16"
---

# 2024-12-16

## Socket write 时间长

![](企业微信截图_17338886989169.png)

```bash
# tshark -r ./merged.pcap | wc -l
16898235
# tshark -r ./merged.pcap -Y '_ws.expert.severity' | wc -l
6216417  # 占比 36.8%
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.168' | wc -l
4812658  # 占比 77.4%
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.166' | wc -l
753393   # 占比 12.1%
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.167' | wc -l
650366   # 占比 10.4%
```

异常路径分析

```bash
# 168 -> 166
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.168 and ip.dst_host == 100.100.100.166 ' | wc -l
2335255

# 168 -> 167
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.168 and ip.dst_host == 100.100.100.167' | wc -l
2477403

# 166 -> 168
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.166 and ip.dst_host == 100.100.100.168' | wc -l
753374

# 167 -> 168
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.167 and ip.dst_host == 100.100.100.168' | wc -l
650349

# 166 -> 167
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.166 and ip.dst_host == 100.100.100.167' | wc -l
19

# 167 -> 166
# tshark -r ./merged.pcap -Y '_ws.expert.severity and ip.src_host == 100.100.100.167 and ip.dst_host == 100.100.100.166' | wc -l
17
```

可以发现异常主要发生在 168 <-> 166 和 168 <-> 167

```
195	6.004	06:59:06.969	100.100.100.168	100.100.100.166	TCP	67	[TCP Spurious Retransmission] 2888 → 56848 [PSH, ACK] Seq=4164 Ack=441 Win=57 Len=1 TSval=3755427323 TSecr=1422345055
```

![](Pasted%20image%2020241216143347.png)
![](Pasted%20image%2020241216143401.png)
![](Pasted%20image%2020241216143613.png)

![](Pasted%20image%2020241216152728.png)
